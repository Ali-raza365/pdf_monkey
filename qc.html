<!DOCTYPE html>
<html lang="en">

<head>
     <meta charset="UTF-8">
     <meta http-equiv="X-UA-Compatible" content="IE=edge">
     <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <title>Document</title>
     <style>
          p {
               position: relative;
          }
     </style>
</head>

<body>
     <!-- 
     <img width="" ; height="" id="barchart">
     <script>
          let barchart = document.getElementById("barchart")
          const chartObj = {
               "type": "doughnut",
               "data": {
                    "datasets": [{
                         "label": "foo",
                         "data": [12, 88],
                         "backgroundColor": [
                              "rgba(255, 8, 155, 0.2)",
                              "rgba(0, 0, 0, 0.1)"
                         ],
                         "textcolor": ["#000555", "#555555"],
                         "borderWidth": 0,
                    }]
               },
               "options": {
                    "rotation": Math.PI,
                    "circumference": Math.PI,
                    "cutoutPercentage": 75,
                    "plugins": {
                         "datalabels": { "display": false },
                         "doughnutlabel": {
                              "labels": [
                                   {
                                        "text": "\nEmail Open Rate",
                                        "color": "#aaa",
                                        "font": {
                                             "size": "25"
                                        },
                                   },
                                   {
                                        "text": "\n12%",
                                        "font": {
                                             "size": "40"
                                        },
                                   },
                              ]
                         }
                    }
               }
          }

          const myFormatterFunction = function (value) {
               return "$" + value
          };
          const chartStr = JSON.stringify(chartObj).replace('"__CALLBACK_PLACEHOLDER__"', myFormatterFunction.toString());
          let dasda = encodeURIComponent(chartStr)
          let str = "https://quickchart.io/chart?c=" + dasda
          console.log(str);
          barchart.src = str

     </script> -->

     <script src="https://unpkg.com/chart.js@2.8.0/dist/Chart.bundle.js"></script>
     <script src="https://unpkg.com/chartjs-gauge@0.3.0/dist/chartjs-gauge.js"></script>
     <script src="https://unpkg.com/chartjs-plugin-datalabels@0.7.0/dist/chartjs-plugin-datalabels.js"></script>

     <div id="canvas-holder" style="width:100%">
          <canvas id="chart"></canvas>
     </div>
     <button id="randomizeData">Randomize Data</button>


     <script>
          var data = [5, 8, 15, 25];
          var value = 17;
          var config = {
               type: 'gauge',
               data: {
                    labels: ['Success', 'Warning', 'Warning', 'Fail'],
                    datasets: [{
                         data: data,
                         value: value,
                         backgroundColor: ['green', 'yellow', 'orange', 'red'],
                         borderWidth: 2
                    }]
               },
               options: {
                    responsive: true,
                    title: {
                         display: true,
                         text: 'Gauge chart with datalabels plugin displaying labels'
                    },
                    layout: {
                         padding: {
                              bottom: 30
                         }
                    },
                    needle: {
                         // Needle circle radius as the percentage of the chart area width
                         radiusPercentage: 2,
                         // Needle width as the percentage of the chart area width
                         widthPercentage: 3.2,
                         // Needle length as the percentage of the interval between inner radius (0%) and outer radius (100%) of the arc
                         lengthPercentage: 80,
                         // The color of the needle
                         color: 'rgba(0, 0, 0, 1)'
                    },
                    valueLabel: {
                         display: false
                    },
                    plugins: {
                         datalabels: {
                              display: true,
                              formatter: function (value, context) {
                                   return context.chart.data.labels[context.dataIndex];
                              },
                              //color: function (context) {
                              //  return context.dataset.backgroundColor;
                              //},
                              color: 'rgba(0, 0, 0, 1.0)',
                              //color: 'rgba(255, 255, 255, 1.0)',
                              backgroundColor: null,
                              font: {
                                   size: 20,
                                   weight: 'bold'
                              }
                         }
                    }
               }
          };


          var ctx = document.getElementById('chart').getContext('2d');
          window.myGauge = new Chart(ctx, config);


          // document.getElementById('randomizeData').addEventListener('click', function () {
          //      config.data.datasets.forEach(function (dataset) {
          //           dataset.data = randomData();
          //           dataset.value = randomValue(dataset.data);
          //      });

          //      window.myGauge.update();
          // });
     </script>
</body>

</html>